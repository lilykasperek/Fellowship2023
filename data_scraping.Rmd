---
title: "data_scraping"
output: html_document
date: "2023-06-06"
---

```{r}
##install.packages("tcltk2")
##install.packages("PDE", dependencies = TRUE)

##install.packages("pdftools")
library(tidyverse)
library(pdftools)

## scan for hurtful and insensitive wording

evals_pdf <- pdf_text("STAT113_Fall_2020_1.pdf") 
evals_pdf 

## https://crimebythenumbers.com/scrape-table.html
tab <- pdf_text("STAT113_Fall_2020_1.pdf")
head(tab)
first_page <- strsplit(tab[1], "\n")[[1]]
first_page |> trimws()
first_page <- noquote(first_page)

tab_read <- tab |> readr::read_lines()
tab_read <- noquote(tab_read)

tab_pdf_1 <- tab_read[-c(1, 2, 71:133)]
tab_pdf_1

tab_pdf_1 |> str_squish()

tab2 <- pdf_text("STAT113_Fall_2020_1.pdf")
head(tab2)
first_page2 <- strsplit(tab2[1], "\n")[[1]]
first_page2 |> trimws()
first_page2 <- noquote(first_page2)
first_page2

tab_pdf_2 <- tab_read[-c(1:76, 128:133)]
tab_pdf_2

one_table <- tab_pdf_2[-c(11:51)]
one_table

one_table[1] |> strsplit("Q6b: I would recommend this")
one_table[3] |> strsplit("Agree strongly                               9      50%        38%")
```

```{r}
install.packages("tabulizer")

if (!require("remotes")) {
    install.packages("remotes")
}
# on 64-bit Windows
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"), INSTALL_opts = "--no-multiarch")
# elsewhere
remotes::install_github(c("ropensci/tabulizerjars", "ropensci/tabulizer"))

library("tabulizer")
f <- system.file("examples", "data.pdf", package = "tabulizer")
out1 <- extract_tables(f)
str(out1)

eval_scrape <- extract_tables(
    file   = "STAT113_Fall_2020_1.pdf", 
    method = "decide", 
    output = "data.frame")

eval_tbl <- eval_scrape %>% 
    pluck(1) %>% 
    as_tibble()
eval_tbl

eval_tbl %>% head() %>% knitr::kable()
```

